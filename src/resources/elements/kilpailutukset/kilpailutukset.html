<template>
  <require from="resources/attributes/select2"></require>
  <require from="resources/components/csv/csv"></require>
  <require from="resources/components/noUiSlider/noUiSlider"></require>
  <require from="resources/components/timeline/timeline"></require>

  <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.2/css/select2.min.css" rel="stylesheet" />

  <section class="w-max-1200 h-center clearfix h-min-100vh Px-md Pt-xl">

    <h1>${ 'kilpailutukset' & t }</h1>

    <div class="relative Mb-xl">
      <div show.bind="api.isLoading" class="flex flex-ai-c flex-jc-c absolute full-width full-height z-10 bg-c-w08">
        <div class="f-center Px-xl Py-md bg-c-w">
          <paper-spinner-lite alt="Ladataan kilpailutuksia" active></paper-spinner-lite>
          <p>${ 'ladataan-kilpailutuksia' & t }</p>
        </div>
      </div>

      <form is="iron-form" class="clearfix Mb-xl bg-c-h P-xl">
      	<div class="clearfix">
          <div class="xs-12 sm-6 Ps-0 Pe-0 r-sm-Pe-1rem">
            <label class="block f-14">${ 'toimivaltainen-viranomainen' & t } <paper-icon-button icon="help" id="organisaatio-tip" class="c-g" style="width: 32px;"></paper-icon-button></label>
            <paper-tooltip for="organisaatio-tip" class="Px-xl w-315" fit-to-visible-bounds>
              <p class="c-w">${ 'organisaatio-tip' & t }</p>
              <ul class="c-w">
                <li repeat.for="organisaatio of inactiveOrganisaatiot">${ organisaatio.nimi }<li>
              </ul>
            </paper-tooltip>
            <select select2.bind="organisaatioSelectOptions" value.bind="filter.organisaatiot" multiple="multiple" class="full-width My-md" change.trigger="onOrganisaatioListChange()">
              <option repeat.for="organisaatio of activeOrganisaatiot" value.bind="organisaatio.id">${organisaatio.nimi}</option>
            </select>
          </div>
          <div class="xs-12 sm-6 Pe-0 Ps-0 r-sm-Ps-1rem Mt-md r-sm-Mt-0">
            <label class="block f-14">${ 'toimivaltaryhma' & t } <paper-icon-button icon="help" id="organisaatiolaji-tip" class="c-g" style="width: 32px;"></paper-icon-button></label>
            <paper-tooltip for="organisaatiolaji-tip" class="Px-xl w-315" fit-to-visible-bounds>
              <p class="c-w">${ 'organisaatiolaji-tip' & t }</p>
            </paper-tooltip>
            <select select2.bind="organisaatiolajiSelectOptions" value.bind="filter.organisaatiolajit" multiple="multiple" class="full-width My-md" change.trigger="onOrganisaatiolajiListChange()">
              <option repeat.for="organisaatiolaji of organisaatiolajit" value.bind="organisaatiolaji.id">${organisaatiolaji.nimi}</option>
            </select>
          </div>
        </div>
        <div class="clearfix">
          <div class="xs-12 sm-6 md-4 Ps-0 Mt-lg Pe-0 r-sm-Pe-1rem">
            <label for="kohdearvo" class="f-14">${ 'kohteen-arvioitu-arvo' & t }</label>
            <div class="clearfix">
              <no-ui-slider id="kohdearvo" options.bind="kohdearvo" class="left Mx-md My-xs w-092"></no-ui-slider>
            </div>
          </div>
          <div class="xs-12 sm-6 md-4 Ps-0 r-sm-Ps-1rem Mt-lg Pe-0 r-sm-Pe-1rem">
            <label for="kalustokoko" class="f-14">${ 'kaluston-maara' & t }</label>
            <div class="clearfix">
              <no-ui-slider id="kalustokoko" options.bind="kalustokoko" class="left full-width Mx-md My-xs w-092"></no-ui-slider>
            </div>
          </div>
          <div class="xs-12 sm-6 md-4 Mt-lg Ps-0 r-md-Ps-1-rem">
            <label class="f-14">${ 'aikajanalla-naytettava-ajanjakso' & t }</label>
            <div class="My-xs f-14">
              <paper-toggle-button class="r-sm-left Me-md" change.delegate="toggleKilpailukausi()" checked.two-way="isKilpailutuskausiChecked">${ 'kilpailutuskausi' & t }</paper-toggle-button>
              <paper-toggle-button change.delegate="toggleLiikennointikausi()" checked.two-way="isLiikennointikausiChecked">${Â 'liikennointikausi' & t }</paper-toggle-button>
            </div>
          </div>
        </div>
      </form>
    </div>

    <div class="clearfix Mb-md">
      <div repeat.for="label of labels" class="left Mb-xs" style="width: 300px;">
        <div class="flex flex-ai-c f-12">
          <div class="w-20 h-20" css="background-color:${label.color};border:${label.border}">
            &nbsp;
          </div>
          <div class="Ms-xs Me-xl">${ label.text }</div>
        </div>
      </div>
    </div>

    <div show.bind="filter.organisaatiot.length || filter.organisaatiolajit.length" class="Mb-5md">
      <p class="f-10 M-0">${ 'ohjeet-aikajanan-zoomaamiseksi' & t }</p>
      <timeline
        events.bind="timeline.events"
        data.bind="timeline.data"
        options.bind="timeline.options">
      </timeline>
    </div>
    <div show.bind="!filter.organisaatiot.length && !filter.organisaatiolajit.length" class="By-xs By-solid B-c-l c-w P-xl">
      <p>${ 'ohjeet-kilpailutusten-filtteroimiseksi' & t }</p>
    </div>

    <div class="clearfix">
      <div class="Pb-xl left full-width">
        <csv if.bind="timeline.data.kilpailutukset.length" filename.bind="title" column-delimiter=";" data.bind="timeline.data.kilpailutukset"></csv>
      </div>
    </div>

  </section>

</template>
